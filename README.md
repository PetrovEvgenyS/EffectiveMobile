# Написать скрипт на bash для мониторинга процесса test в среде linux.

## Скрипт должен отвечать следующим требованиям:

1. Запускаться при запуске системы (предпочтительно написать юнит systemd в дополнение к скрипту)
2. Отрабатывать каждую минуту
3. Если процесс запущен, то стучаться(по https) на https://test.com/monitoring/test/api
4. Если процесс был перезапущен, писать в лог /var/log/monitoring.log (если процесс не запущен, то ничего не делать)
5. Если сервер мониторинга не доступен, так же писать в лог.



## Описание юнитов:

- `test-monitor.service`: Сервисный юнит с секцией `[Service]`. Он выполняет скрипт `monitor_test.sh`, который мониторит процесс `test`, отправляет HTTPS-запросы и пишет в лог.
- `test-monitor.timer`: Таймерный юнит с секцией `[Timer]`. Он задает расписание (каждую минуту через `OnCalendar=*:0/1`) для запуска `test-monitor.service`.

В systemd для периодического выполнения задачи (каждую минуту) стандартно используются два юнита: сервис (что выполнять) и таймер (когда выполнять).
Сервисный юнит не может сам по себе запускаться по расписанию — для этого нужен таймер.
Объединить их в один юнит невозможно, так как секции `[Service]` и `[Timer]` принадлежат разным типам юнитов.


## На будущее:

Логи и PID сохраняются в стандартных местах, но нет проверки владельца PID-файла или защиты от перезаписи.
Лучше явно устанавливать права и владельца PID-файла.
Из рекомендаций - лучше использовать `pgrep -x "$PROCESS_NAME" | head -n 1` - он даст первый найденный PID с точным совпадением имени.